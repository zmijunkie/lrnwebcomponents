!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@lrnwebcomponents/md-block/md-block.js"),require("@lrnwebcomponents/video-player/video-player.js"),require("lit"),require("@lrnwebcomponents/simple-colors/simple-colors.js"),require("@lrnwebcomponents/i18n-manager/lib/I18NMixin.js"),require("@lrnwebcomponents/utils/utils.js"),require("@lrnwebcomponents/utils/lib/gSheetsInterface.js"),require("@lrnwebcomponents/es-global-bridge/es-global-bridge.js"),require("@lrnwebcomponents/simple-fields/lib/simple-fields-field.js"),require("@lrnwebcomponents/simple-fields/lib/simple-fields-tag-list.js"),require("@lrnwebcomponents/a11y-collapse/a11y-collapse.js"),require("@lrnwebcomponents/a11y-collapse/lib/a11y-collapse-group.js"),require("@lrnwebcomponents/editable-table/lib/editable-table-display.js"),require("@lrnwebcomponents/a11y-tabs/a11y-tabs.js"),require("@lrnwebcomponents/a11y-tabs/lib/a11y-tab.js"),require("@lrnwebcomponents/grid-plate/grid-plate.js"),require("@lrnwebcomponents/iframe-loader/lib/loading-indicator.js"),require("@lrnwebcomponents/simple-tooltip/simple-tooltip.js"),require("mobx"),require("@github/time-elements"),require("@lrnwebcomponents/simple-icon/lib/simple-icon-lite.js"),require("@lrnwebcomponents/simple-icon/lib/simple-icons.js"),require("@lrnwebcomponents/simple-popover/simple-popover.js"),require("idb-keyval"),require("@lrnwebcomponents/file-system-broker/lib/xlsx-file-system-broker.js")):"function"==typeof define&&define.amd?define(["exports","@lrnwebcomponents/md-block/md-block.js","@lrnwebcomponents/video-player/video-player.js","lit","@lrnwebcomponents/simple-colors/simple-colors.js","@lrnwebcomponents/i18n-manager/lib/I18NMixin.js","@lrnwebcomponents/utils/utils.js","@lrnwebcomponents/utils/lib/gSheetsInterface.js","@lrnwebcomponents/es-global-bridge/es-global-bridge.js","@lrnwebcomponents/simple-fields/lib/simple-fields-field.js","@lrnwebcomponents/simple-fields/lib/simple-fields-tag-list.js","@lrnwebcomponents/a11y-collapse/a11y-collapse.js","@lrnwebcomponents/a11y-collapse/lib/a11y-collapse-group.js","@lrnwebcomponents/editable-table/lib/editable-table-display.js","@lrnwebcomponents/a11y-tabs/a11y-tabs.js","@lrnwebcomponents/a11y-tabs/lib/a11y-tab.js","@lrnwebcomponents/grid-plate/grid-plate.js","@lrnwebcomponents/iframe-loader/lib/loading-indicator.js","@lrnwebcomponents/simple-tooltip/simple-tooltip.js","mobx","@github/time-elements","@lrnwebcomponents/simple-icon/lib/simple-icon-lite.js","@lrnwebcomponents/simple-icon/lib/simple-icons.js","@lrnwebcomponents/simple-popover/simple-popover.js","idb-keyval","@lrnwebcomponents/file-system-broker/lib/xlsx-file-system-broker.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).GradeBook={},null,null,e.lit,e.simpleColors_js,e.I18NMixin_js,e.utils_js,e.gSheetsInterface_js,e.esGlobalBridge_js,null,null,null,null,null,null,null,null,null,null,e.mobx,null,null,null,null,e.idbKeyval,e.xlsxFileSystemBroker_js)}(this,(function(e,t,n,i,a,s,r,o,l,d,c,u,h,p,g,m,b,v,f,y,w,k,S,x,A,R){"use strict";function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function q(e,t,n,i,a,s,r){try{var o=e[s](r),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(i,a)}function _(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var s=e.apply(t,n);function r(e){q(s,i,a,r,o,"next",e)}function o(e){q(s,i,a,r,o,"throw",e)}r(void 0)}))}}function D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function L(e,t,n){return t&&I(e.prototype,t),n&&I(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N(e,t)}function G(e){return G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},G(e)}function N(e,t){return N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},N(e,t)}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return z(e)}function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=G(e);if(t){var a=G(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return P(this,n)}}function C(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=G(e)););return e}function T(){return T="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=C(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},T.apply(this,arguments)}function M(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function U(e){return function(e){if(Array.isArray(e))return H(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||W(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){if(e){if("string"==typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?H(e,t):void 0}}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}y.configure({enforceActions:!1,useProxies:"ifavailable"});var J=function(e){E(n,e);var t=F(n);function n(){var e;return D(this,n),(e=t.call(this)).gradeScale=[],e.activeRubric=[],e.database={tags:{categories:[],data:[]},submissions:[],rubrics:[],assignments:[],roster:[],grades:{},gradesDetails:{},gradeScale:[],settings:{}},e.activeStudent=0,e.activeAssignment=0,y.makeObservable(z(e),{gradeScale:y.observable,activeStudent:y.observable,activeRubric:y.observable,activeAssignment:y.observable,database:y.observable,activeSubmission:y.computed}),e}return L(n,[{key:"activeSubmission",get:function(){var e=y.toJS(this.database),t=y.toJS(this.activeStudent),n=y.toJS(this.activeAssignment);for(var i in this.database.submissions){var a=this.database.submissions[i];if(a.student===e.roster[t].student&&a[e.assignments[n].shortName])return a[e.assignments[n].shortName]}return null}}],[{key:"tag",get:function(){return"grade-book-store"}}]),n}(i.LitElement);customElements.define(J.tag,J),window.GradeBookStore=window.GradeBookStore||{},window.GradeBookStore.requestAvailability=function(){return window.GradeBookStore.instance||(window.GradeBookStore.instance=document.createElement("grade-book-store"),document.body.appendChild(window.GradeBookStore.instance)),window.GradeBookStore.instance};var V,X,Y,K,$,Q,Z,ee,te,ne,ie,ae=window.GradeBookStore.requestAvailability(),se=function(e){E(n,e);var t=F(n);function n(){var e;return D(this,n),(e=t.call(this)).pointsSystem="pts",e.score=null,e.total=null,e.gradeScale=[],e.displayOnly=!1,e._letterIndex=null,e.letter="",e.showScale=!1,e.value="",e.mini=!1,e.label="",e.active=!1,y.autorun((function(){e.gradeScale=y.toJS(ae.gradeScale)})),e}return L(n,[{key:"render",value:function(){return i.html(V||(V=M(['\n      <div class="wrap">\n        <div class="letter">',"</div>\n        ","\n        ","\n      </div>\n      ","\n    "])),this.letter,this.showScale&&null!==this._letterIndex?i.html(X||(X=M(['<div class="score">\n              (',"/"," ",")\n            </div>"])),this.score,this.total,this.pointsSystem):"",this.showScale&&null!==this._letterIndex?i.html(Y||(Y=M(['<div class="range">\n              ',"% -\n              ","%\n            </div>"])),this.gradeScale[this._letterIndex].lowRange,this.gradeScale[this._letterIndex].highRange):"",this.mini?i.html(K||(K=M(['<simple-tooltip position="top"\n            >',"<br />","</simple-tooltip\n          >"])),this.label,null!=this.score?i.html($||($=M(["(","/"," ",")"])),this.score,this.total,this.pointsSystem):""):"")}},{key:"updated",value:function(e){var t=this;e.forEach((function(e,n){"mini"===n&&t[n]&&t.label,["total","score","gradeScale"].includes(n)&&!t.displayOnly&&t.gradeScale.length>0&&(t.letter=t.calculateLetterGrade()),"letter"===n&&t.gradeScale[t._letterIndex]&&(t.innerHTML='\n        <div>---------------------------------------</div>\n        <div style="font-size:36px;line-height:48px;">'.concat(t.letter,'</div>\n        <div style="font-size:20px;line-height:24px;">').concat(t.score,"/").concat(t.total," ").concat(t.pointsSystem,'</div>\n        <div style="font-size:16px;line-height:24px;">Range: ').concat(t.gradeScale[t._letterIndex].lowRange,"% -\n        ").concat(t.gradeScale[t._letterIndex].highRange,"%</div>\n        <div>---------------------------------------</div>\n        "))}))}},{key:"calculateLetterGrade",value:function(){if(null===this.score)return"/";var e=this.score/this.total*100;if(this.gradeScale[0]&&e>=this.gradeScale[0].highRange)return this._letterIndex=0,this.gradeScale[0].letter;for(var t in this.gradeScale){var n=this.gradeScale[t];if(e<=n.highRange&&e>=n.lowRange)return this._letterIndex=t,this.gradeScale[t].letter}return this._letterIndex=this.gradeScale.length-1,this.gradeScale[this.gradeScale.length-1].letter}}],[{key:"styles",get:function(){return[i.css(Q||(Q=M(['\n        :host {\n          display: block;\n        }\n        :host([letter="/"]) {\n          --letter-grade-default-letter-background-color: #cccccc;\n        }\n        :host([letter="F"]) {\n          --letter-grade-default-letter-background-color: #ff4444;\n        }\n        :host([letter="D"]) {\n          --letter-grade-default-letter-background-color: #ff7744;\n        }\n        :host([letter="C"]),\n        :host([letter="C+"]) {\n          --letter-grade-default-letter-background-color: #ffff00;\n        }\n        :host([letter="B"]),\n        :host([letter="B-"]) {\n          --letter-grade-default-letter-background-color: #ffff66;\n        }\n        :host([letter="B+"]),\n        :host([letter="A-"]) {\n          --letter-grade-default-letter-background-color: #aaffaa;\n        }\n        :host([letter="A"]) {\n          --letter-grade-default-letter-background-color: #55ff55;\n        }\n        :host([show-scale]) .wrap {\n          height: var(--letter-grade-wrap-height, 64px);\n          width: var(--letter-grade-wrap-width, 64px);\n        }\n        :host([mini]) .wrap {\n          height: var(--letter-grade-wrap-height, 20px);\n          width: var(--letter-grade-wrap-width, 20px);\n          border: 1px solid black;\n          border-radius: 0px;\n          padding: 8px;\n        }\n        :host([mini]) .letter {\n          font-size: var(--letter-grade-letter-font-size, 12px);\n          line-height: var(\n            --letter-grade-letter-line-height,\n            var(--letter-grade-letter-font-size, 20px)\n          );\n        }\n        .wrap {\n          height: var(--letter-grade-wrap-height, 40px);\n          width: var(--letter-grade-wrap-width, 40px);\n          padding: var(--letter-grade-wrap-padding, 16px);\n          border: var(--letter-grade-wrap-border, 4px solid black);\n          border-radius: 50%;\n          box-shadow: rgb(0 0 0 / 20%) 0px 5px 5px 0px;\n          text-align: center;\n          justify-content: center;\n          vertical-align: middle;\n          background-color: var(\n            --letter-grade-wrap-background-color,\n            var(--letter-grade-default-letter-background-color, transparent)\n          );\n        }\n        .letter {\n          font-weight: var(--letter-grade-letter-font-weight, bold);\n          font-size: var(--letter-grade-letter-font-size, 40px);\n          line-height: var(\n            --letter-grade-letter-line-height,\n            var(--letter-grade-letter-font-size, 40px)\n          );\n          letter-spacing: 2px;\n        }\n        .score,\n        .range {\n          font-weight: var(--letter-grade-range-font-weight, normal);\n          font-size: var(--letter-grade-range-font-size, 12px);\n        }\n        simple-tooltip {\n          --simple-tooltip-background: #000000;\n          --simple-tooltip-opacity: 1;\n          --simple-tooltip-text-color: #ffffff;\n          --simple-tooltip-delay-in: 0;\n          --simple-tooltip-duration-in: 200ms;\n          --simple-tooltip-duration-out: 0;\n          --simple-tooltip-border-radius: 0;\n          --simple-tooltip-font-size: 14px;\n          --simple-tooltip-width: 145px;\n        }\n      '])))]}},{key:"properties",get:function(){return{score:{type:Number},total:{type:Number},value:{type:Number},pointsSystem:{type:String,attribute:"points-system"},gradeScale:{type:Array},letter:{type:String,reflect:!0},showScale:{type:Boolean,reflect:!0,attribute:"show-scale"},mini:{type:Boolean,reflect:!0},label:{type:String},displayOnly:{type:Boolean,attribute:"display-only"},active:{type:Boolean,reflect:!0}}}},{key:"tag",get:function(){return"letter-grade"}}]),n}(i.LitElement);customElements.define(se.tag,se);var re,oe,le,de,ce,ue,he,pe,ge,me=function(e){E(n,e);var t=F(n);function n(){var e;return D(this,n),(e=t.call(this)).value=null,e.label=null,e.reveal=!1,e.arrow=!1,e.input=!1,e.possible=0,e.score=0,e}return L(n,[{key:"render",value:function(){var e=this;return i.html(Z||(Z=M(['\n      <div class="wrapper">\n        <slot name="prefix"><span class="prefix">',"</span></slot>\n        ","\n        ",'\n        <slot name="suffix"></slot>\n        ',"\n      </div>\n    "])),this.label,ae.gradeScale.map((function(t,n){return i.html(ee||(ee=M(['\n            <button\n              ?data-selected-value="','"\n              letter="','"\n              id="btn','"\n              @click="','"\n              @mousedown="','"\n              @mouseover="','"\n              @focusin="','"\n              @mouseout="','"\n              @focusout="','"\n            >\n              <letter-grade\n                interactive\n                display-only\n                letter="','"\n                mini\n              ></letter-grade>\n            </button>\n          '])),t.letter==e.value,t.letter,n,e.clickScore,e.activeEventOn,e.activeEventOn,e.activeEventOn,e.activeEventOff,e.activeEventOff,t.letter)})),this.input?i.html(te||(te=M(['\n              <span class="score-wrapper">\n                <simple-fields-field\n                  type="number"\n                  part="simple-fields-field"\n                  min="0"\n                  value="','"\n                  max="','"\n                  @value-changed="','"\n                  maxlength="10"\n                ></simple-fields-field>\n                / ',"</span\n              >\n            "])),this.score,this.possible,this.scoreUpdated,this.possible):i.nothing,this.input?i.html(ne||(ne=M([""]))):i.nothing)}},{key:"activeEventOn",value:function(e){e.target.setAttribute("active","active")}},{key:"activeEventOff",value:function(e){e.target.removeAttribute("active")}},{key:"clickScore",value:function(e){var t=this;this.value=e.target.getAttribute("letter");var n=y.toJS(ae.gradeScale.find((function(e){return t.value===e.letter})));this.score=Math.round(n.highRange/100*this.possible*100)/100}},{key:"scoreUpdated",value:function(e){var t=Math.round(e.detail.value/this.possible*100*100)/100,n=y.toJS(ae.gradeScale.find((function(e){return e.highRange>=t&&t>=e.lowRange})));this.value=n.letter}},{key:"updated",value:function(e){var t=this;e.forEach((function(e,n){"input"===n&&t[n],"reveal"===n&&t[n],["value","score"].includes(n)&&t.dispatchEvent(new CustomEvent("".concat(n,"-changed"),{composed:!1,bubbles:!1,cancelable:!0,detail:t}))}))}}],[{key:"properties",get:function(){return{value:{type:String},label:{type:String},reveal:{type:Boolean},arrow:{type:Boolean},input:{type:Boolean},possible:{type:Number},score:{type:Number}}}},{key:"styles",get:function(){return[i.css(ie||(ie=M(['\n        :host {\n          display: block;\n          font-size: 18px;\n        }\n        letter-grade {\n          display: inline-flex;\n          filter: brightness(80%) saturate(50%);\n        }\n        .wrapper {\n          display: flex;\n        }\n        span.prefix,\n        .wrapper ::slotted(*) {\n          margin-right: 10px;\n          width: 90px;\n          line-height: 38px;\n          display: block;\n          padding: 0;\n          text-align: end;\n          height: 38px;\n        }\n        button {\n          background-color: transparent;\n          padding: 0;\n          margin: 0;\n          border: none;\n          border-radius: none;\n          cursor: pointer;\n        }\n        button[active="active"] letter-grade,\n        letter-grade[active="active"] {\n          filter: brightness(90%) saturate(4);\n          outline: 2px solid black;\n          outline-offset: -2px;\n        }\n        button[data-selected-value] letter-grade {\n          filter: brightness(100%) saturate(1);\n          outline: 4px solid black;\n          outline-offset: -4px;\n        }\n        .score-wrapper {\n          display: flex;\n          font-size: 28px;\n          line-height: 36px;\n          word-spacing: -4px;\n        }\n        simple-fields-field {\n          width: 64px;\n          margin: 0px -8px 0px 16px;\n          --simple-fields-font-size: 28px;\n        }\n      '])))]}},{key:"tag",get:function(){return"letter-grade-picker"}}]),n}(i.LitElement);customElements.define(me.tag,me);var be,ve,fe,ye,we,ke,Se,xe,Ae,Re,je,Oe,qe,_e,De=function(e){E(n,e);var t=F(n);function n(){var e;return D(this,n),(e=t.call(this)).student={},e.t={profileImageFor:"Profile image for",userID:"User ID",preferredName:"Preferred name",emailAddress:"Email this student",notes:"Notes",interests:"Interests"},e.registerLocalization({context:z(e),namespace:"grade-book"}),e}return L(n,[{key:"render",value:function(){return i.html(re||(re=M(['\n      <grid-plate layout="1-2" disable-responsive>\n        <div slot="col-1" style="text-align:center;">\n          ','\n        </div>\n        <div slot="col-2">\n          <h2>',"</h2>\n          <ul>\n            ","\n            ","\n            ","\n            ","\n            ","\n          </ul>\n        </div>\n      </grid-plate>\n    "])),this.student.photo?i.html(oe||(oe=M(['\n                <img\n                  src="','"\n                  alt="'," ",'"\n                />\n              '])),this.student.photo,this.t.photoOf,this.student.prefName):i.html(le||(le=M(['\n                <simple-icon-lite icon="account-circle"></simple-icon-lite>\n              ']))),this.student.name,this.student.userId?i.html(de||(de=M(["<li>",": ","</li>"])),this.t.userID,this.student.userId):"",this.student.prefName?i.html(ce||(ce=M(["<li>",": ","</li>"])),this.t.preferredName,this.student.prefName):"",this.student.email?i.html(ue||(ue=M(['<li>\n                  <a href="mailto:','"\n                    >',"</a\n                  >\n                </li>"])),this.student.email,this.t.emailAddress):"",this.student.notes?i.html(he||(he=M(["<li>",": ","</li>"])),this.t.notes,this.student.notes):"",this.student.interests?i.html(pe||(pe=M(["<li>\n                  ",": ","\n                </li>"])),this.t.interests,this.student.interests.join(",")):"")}}],[{key:"properties",get:function(){return{student:{type:Object}}}},{key:"styles",get:function(){return i.css(ge||(ge=M(["\n      :host {\n        display: block;\n      }\n      img {\n        max-width: 150px;\n        height: 150px;\n        border-radius: 50%;\n      }\n      grid-plate {\n        --grid-plate-col-transition: none;\n        --grid-plate-item-margin: 0px;\n        --grid-plate-item-padding: 4px;\n      }\n      simple-icon-lite {\n        --simple-icon-height: 150px;\n        --simple-icon-width: 150px;\n      }\n    "])))}},{key:"tag",get:function(){return"grade-book-student-block"}}]),n}(s.I18NMixin(i.LitElement));customElements.define(De.tag,De);var Ie,Le,Be,Ee,Ge,Ne,ze,Pe,Fe,Ce,Te,Me,Ue,We,He,Je,Ve,Xe,Ye,Ke,$e,Qe,Ze,et,tt,nt,it,at,st,rt,ot,lt,dt,ct,ut,ht,pt,gt,mt,bt,vt,ft,yt,wt,kt,St,xt,At,Rt=function(e){E(n,e);var t=F(n);function n(){var e;return D(this,n),(e=t.call(this)).t={studentSubmission:"Student submission",openInNewWindow:"Open in new window",submitted:"Submitted"},y.autorun((function(){e.activeSubmission=y.toJS(ae.activeSubmission)})),e}return L(n,[{key:"createRenderRoot",value:function(){return this}},{key:"changeActive",value:function(e){var t=e.target.value.split("-");switch(t[0]){case"prev":ae["active".concat(t[1])]--;break;case"next":ae["active".concat(t[1])]++}}},{key:"render",value:function(){return i.html(Ie||(Ie=M(['\n      <style>\n        grade-book-pop-up .shortcut-btns {\n          position: sticky;\n          background-color: var(\n            --simple-colors-default-theme-accent-12,\n            #001333\n          );\n          color: var(--simple-colors-default-theme-accent-1, #e2ecff);\n          height: 36px;\n          vertical-align: middle;\n          width: 100%;\n          display: flex;\n        }\n        grade-book-pop-up .shortcut-btns button {\n          background: transparent;\n          margin: 0 10px;\n          padding: 4px 8px;\n          font-size: 12px;\n          color: var(--simple-colors-default-theme-accent-1, #e2ecff);\n          border: none;\n          outline: 1px solid white;\n          cursor: pointer;\n        }\n        .active-submission {\n          overflow: hidden;\n          /* 16:9 aspect ratio */\n          padding-top: 56.25%;\n          position: relative;\n        }\n\n        .active-submission iframe {\n          border: 0;\n          height: 100%;\n          left: 0;\n          position: absolute;\n          top: 0;\n          width: 100%;\n        }\n      </style>\n      <div class="shortcut-btns">\n        <button @click="','" value="prev-Student">\n          Previous student\n        </button>\n        <button @click="','" value="next-Student">\n          Next student\n        </button>\n        <button @click="','" value="prev-Assignment">\n          Previous assignment\n        </button>\n        <button @click="','" value="next-Assignment">\n          Next assignment\n        </button>\n      </div>\n      <div class="assignment-container">\n        ',"\n      </div>\n    "])),this.changeActive,this.changeActive,this.changeActive,this.changeActive,this.renderStudentSubmission(this.activeSubmission))}},{key:"renderStudentSubmission",value:function(e){var t=i.html(Le||(Le=M(["<h3>","</h3>\n      ",'\n      <relative-time\n        .datetime="','"\n      ></relative-time> '])),this.t.studentSubmission,this.t.submitted,ae.database.assignments[ae.activeAssignment]._ISODueDate);return r.validURL(e)?i.html(Be||(Be=M(["",'<a\n          href="','"\n          target="_blank"\n          rel="noopener noreferrer"\n        >\n          <button>','</button></a\n        >\n        <div class="active-submission">\n          <iframe\n            width="560"\n            height="315"\n            loading="lazy"\n            src="','"\n            frameborder="0"\n            allow="encrypted-media;"\n            allowfullscreen\n          ></iframe>\n        </div>'])),t,e,this.t.openInNewWindow,r.cleanVideoSource(e)):i.html(Ee||(Ee=M(["",'\n        <div class="active-submission">\n          <md-block .markdown="','"></md-block>\n        </div>'])),t,e)}}],[{key:"tag",get:function(){return"grade-book-pop-up"}},{key:"properties",get:function(){return O(O({},T(G(n),"properties",this)),{},{activeSubmission:{type:String},data:{type:String}})}}]),n}(s.I18NMixin(i.LitElement));customElements.define(Rt.tag,Rt);var jt=function(e){E(d,e);var t,n,a,s=F(d);function d(){var e;return D(this,d),(e=s.call(this)).hasFilePicker=!1,e.source="googledocs",window.showOpenFilePicker&&(e.source="filesystem",e.hasFilePicker=!0),e.ready=!1,e.displayMode=0,e.assessmentView=e.resetAssessmentView(),e.totalScore=0,e.activeStudentSubmissions=[],e.scoreLock=!0,e.activeRubric=[],e.activeGrading={},e.settings={photo:!0,fname:!0,surname:!0,email:!0},e.disabled=!1,e.loading=!1,e.t={csvURL:"CSV URL",points:"Points",criteria:"Criteria",description:"Description",assessmentWeight:"Assessment weight",overallFeedback:"Overall feedback",letterGrade:"Letter grade",highRange:"High range",lowRange:"Low range",noSubmission:"No submission found",studentSubmission:"Student submission",openInNewWindow:"Open in new window",gradingScale:"Grading scale",activeStudent:"Active student",activeAssignment:"Active assignment",submitted:"Submitted",dueDate:"Due date",firstName:"First name",surname:"Surname",photo:"Photo",email:"Email",settings:"Settings",previous:"Previous",next:"Next",previousStudent:"Previous student",nextStudent:"Next student",previousAssignment:"Previous assignment",nextAssignment:"Next assignment",student:"Student",assessmentView:"Assessment View",activeAssessment:"Active assessment",studentReportView:"Student report view",loadGradebook:"Load gradebook",load:"Load",saveGradebook:"Save gradebook",selectGradebookSource:"Select gradebook source",sourceData:"Source data",pasteValidJSONHere:"Paste valid JSON here",loadingFilePleaseWait:"LOADING FILE PLEASE WAIT.."},e.registerLocalization({context:z(e),basePath:"undefined"==typeof document&&"undefined"==typeof location?new(require("url").URL)("file:"+__filename).href:"undefined"==typeof document?location.href:document.currentScript&&document.currentScript.src||new URL("grade-book.umd.js",document.baseURI).href,locales:["es","fr","de"]}),e.addEventListener("simple-fields-tag-list-changed",e.qualitativeFeedbackUpdate.bind(z(e))),e.addEventListener("value-changed",e.rubricCriteriaPointsChange),e.addEventListener("drop",e._handleDragDrop.bind(z(e))),y.autorun((function(){e.activeStudent=y.toJS(ae.activeStudent)})),y.autorun((function(){e.activeAssignment=y.toJS(ae.activeAssignment)})),y.autorun((function(){e.database=y.toJS(ae.database)})),y.autorun((function(){e.activeSubmission=y.toJS(ae.activeSubmission)})),e}return L(d,[{key:"firstUpdated",value:function(e){var t=this;T(G(d.prototype),"firstUpdated",this)&&T(G(d.prototype),"firstUpdated",this).call(this,e),new ResizeObserver((function(e){clearTimeout(t.__resizer),t.__resizer=setTimeout((function(){var n,i=0,a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=W(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){o=!0,s=e},f:function(){try{r||null==n.return||n.return()}finally{if(o)throw s}}}}(e);try{for(a.s();!(n=a.n()).done;){var s=n.value;i=s.contentBoxSize?Math.round(window.innerHeight-s.contentBoxSize[0].blockSize-122):Math.round(window.innerHeight-s.contentRect.height-122)}}catch(e){a.e(e)}finally{a.f()}t.shadowRoot.querySelector("#studentassessment").shadowRoot.querySelector("[part='content']").style.height=i+"px"}),50)})).observe(this.shadowRoot.querySelector("#studentgrid")),setTimeout(_(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.get("grade-book-prev-file");case 2:t.prevLocalFileReference=e.sent,t.requestUpdate();case 4:case"end":return e.stop()}}),e)}))),0)}},{key:"resetAssessmentView",value:function(){return{qualitative:[],written:[]}}},{key:"getStudentSubmissions",value:function(e){var t=[];for(var n in this.database.submissions){var i=this.database.submissions[n];if(i.student===this.database.roster[e].student){for(var a in i)if("student"!==a){var s=this.getAssignmentByShortName(a);s&&t.push({studentScore:this.database.grades[e]&&""!=this.database.grades[e][a]?this.database.grades[e][a]:null,assignmentPoints:s.points,assignmentName:s.name,assignmentIndex:s.index})}return t}}return t}},{key:"getAssignmentByShortName",value:function(e){var t,n=this.database.assignments.filter((function(n,i){return n.shortName===e&&(t=i,!0)}));return 1===n.length?(n[0].index=t,n[0]):null}},{key:"getCurrentScore",value:function(e,t){return this.database.grades[e]&&this.database.grades[e][this.database.assignments[t].shortName]?this.database.grades[e][this.database.assignments[t].shortName]:0}},{key:"getActiveRubric",value:function(){var e=this;return this.database.rubrics.filter((function(t){return t.shortName==e.database.assignments[e.activeAssignment].rubric}))}},{key:"updated",value:function(e){var t=this;T(G(d.prototype),"updated",this)&&T(G(d.prototype),"updated",this).call(this,e),e.forEach((function(e,n){if(!t.loading&&["activeAssignment","activeStudent","database","loading"].includes(n)&&(setTimeout((function(){t.totalScore=t.getCurrentScore(t.activeStudent,t.activeAssignment),t.assessmentView=t.resetAssessmentView(),t.activeRubric=U(t.getActiveRubric()),t.hideRubricInfo=U(t.activeRubric.map((function(){return!1}))),t.activeStudentSubmissions=[],t.activeStudentSubmissions=U(t.getStudentSubmissions(t.activeStudent)),2==t.displayMode&&t.renderSubmissionInWindow()}),0),t.maintainScrollPosition()),["sourceData","source"].includes(n))if(t.sourceData)switch(t.source){case"googledocs":t.loading=!0,t.gSheet=new o.gSheetInterface(t,t.sourceData,{tags:0,roster:118800528,assignments:540222065,rubrics:1744429439,submissions:2104732668,gradeScale:980501320,grades:2130903440,gradesDetails:644559151,settings:1413275461}),setTimeout(_(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=regeneratorRuntime.keys(t.gSheet.sheetGids);case 1:if((e.t1=e.t0()).done){e.next=13;break}return n=e.t1.value,e.next=5,t.gSheet.loadSheetData(n);case 5:i=e.sent,i=t.transformTable(i),"function"==typeof t["process".concat(n,"Data")]&&(i=t["process".concat(n,"Data")](i)),t.database[n]=i,"gradeScale"===n&&t.database.gradeScale&&t.database.gradeScale.length>0&&(ae.gradeScale=t.database.gradeScale),t.requestUpdate(),e.next=1;break;case 13:t.importStateCleanup();case 14:case"end":return e.stop()}}),e)}))),0);break;case"url":t.loading=!0,fetch(t.sourceData).then((function(e){if(e.ok)return e.json()})).then((function(e){ae.database=e,t.importStateCleanup()})).catch((function(e){console.warn(e)}));break;case"json":ae.database=JSON.parse(t.sourceData),t.importStateCleanup()}else"filesystem"==t.source&&(t.__applied||(t.__applied=!0,window.addEventListener("xlsx-file-system-data",(function(e){var n=e.detail.data;for(var i in n){var a=t.transformTable(n[i]);"function"==typeof t["process".concat(i,"Data")]&&(a=t["process".concat(i,"Data")](a)),ae.database[i]=a}t.importStateCleanup()}))))}))}},{key:"importStateCleanup",value:function(){this.loading=!1,this.database.gradeScale&&this.database.gradeScale.length>0&&(ae.gradeScale=this.database.gradeScale),this.requestUpdate(),this.ready=!0}},{key:"transformTable",value:function(e){var t=e.shift(),n={},i=[];for(var a in t)n[t[a]]=a;for(var a in e){var s={};for(var r in n)s[r]=e[a][n[r]];i.push(s)}return i}},{key:"maintainScrollPosition",value:function(){var e=this;this.shadowRoot&&this.shadowRoot.querySelector("#studentgrid [data-active]")&&setTimeout((function(){var t=r.isElementInViewport(e.shadowRoot.querySelector("#studentgrid [data-active]"),{top:0,right:window.innerWidth,bottom:e.shadowRoot.querySelector("#studentgrid").getBoundingClientRect().height+20,left:192});0===ae.activeStudent?e.shadowRoot.querySelector("#studentgrid").scrollTop=0:t||(e.shadowRoot.querySelector("#studentgrid").scrollTop=e.shadowRoot.querySelector("#studentgrid [data-active]").offsetTop-e.shadowRoot.querySelector("#studentgrid").offsetTop),0===ae.activeAssignment?e.shadowRoot.querySelector("#studentgrid").scrollLeft=0:t||(e.shadowRoot.querySelector("#studentgrid").scrollLeft=e.shadowRoot.querySelector("#studentgrid [data-active]").offsetLeft-192-e.shadowRoot.querySelector("#studentgrid").offsetLeft)}),0)}},{key:"processassignmentsData",value:function(e){for(var t in e)if(""!=e[t].dueDate)try{var n=new Date("".concat(e[t].dueDate," ").concat(e[t].dueTime));e[t]._ISODueDate=n.toISOString()}catch(e){}return e}},{key:"processtagsData",value:function(e){var t=new Set([]),n=[];for(var i in e)e[i].category=e[i].category?e[i].category.split(","):[],e[i].associatedMaterial=e[i].associatedMaterial?e[i].associatedMaterial.split(","):[],e[i].category.forEach((function(e){t.add(e)})),n=U(Array.from(t));return{categories:n,data:e}}},{key:"processrubricsData",value:function(e){for(var t in e)e[t].qualitative=e[t].qualitative?e[t].qualitative.split(","):[];return e}},{key:"processrosterData",value:function(e){for(var t in e)e[t].interests=e[t].interests?e[t].interests.split(","):[];return e}},{key:"processsettingsData",value:function(e){var t={};for(var n in e)t[e[n].key]=e[n].value;return t}},{key:"changeStudent",value:(a=_(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.shadowRoot.querySelectorAll("#studentgrid .th-or-td").forEach((function(e){e.classList.remove("col-highlight")})),"prev"==t.target.getAttribute("value")&&0!==this.activeStudent?ae.activeStudent--:"next"==t.target.getAttribute("value")&&this.database.roster.length-1!==this.activeStudent&&ae.activeStudent++,e.next=4,this.requestUpdate();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"changeAssignment",value:(n=_(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.shadowRoot.querySelectorAll("#studentgrid .th-or-td").forEach((function(e){e.classList.remove("col-highlight")})),"prev"==t.target.getAttribute("value")&&0!==this.activeAssignment?ae.activeAssignment--:"next"==t.target.getAttribute("value")&&this.database.assignments.length-1!==ae.activeAssignment&&ae.activeAssignment++,e.next=4,this.requestUpdate();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"renderSubmission",value:function(e){var t=parseInt(this.shadowRoot.querySelector("#studentgrid").getBoundingClientRect().height);this.shadowRoot.querySelector("#studentassessment").shadowRoot.querySelector("[part='content']").style.height=Math.round(window.innerHeight-t-104)+"px";var n=i.html(Ge||(Ge=M(["<h3>","</h3>\n      ",'\n      <relative-time\n        .datetime="','"\n      ></relative-time> '])),this.t.studentSubmission,this.t.submitted,this.database.assignments[this.activeAssignment]._ISODueDate);return r.validURL(e)?(n=i.html(Ne||(Ne=M(["",'<a\n          href="','"\n          target="_blank"\n          rel="noopener noreferrer"\n          ><simple-icon-button-lite\n            label="','"\n            icon="open-in-new"\n          ></simple-icon-button-lite\n        ></a>'])),n,e,this.t.openInNewWindow),e!=r.cleanVideoSource(e)?i.html(ze||(ze=M(["",'<video-player\n            class="active-submission"\n            source="','"\n            width="60%"\n          ></video-player>'])),n,e):i.html(Pe||(Pe=M(["",'\n          <div class="active-submission">\n            <iframe\n              src="','"\n              loading="lazy"\n              width="100%"\n              height="100%"\n            ></iframe>\n          </div>'])),n,e)):i.html(Fe||(Fe=M(["",'\n        <div class="active-submission">\n          <md-block .markdown="','"></md-block>\n        </div>'])),n,e)}},{key:"studentLetterGradeHistoryClick",value:function(e){ae.activeAssignment=parseInt(e.target.value),this.requestUpdate()}},{key:"activateOption",value:function(e){var t=r.normalizeEventPath(e);t[0].getAttribute("data-student")&&t[0].getAttribute("data-assignment")&&(ae.activeAssignment=parseInt(t[0].getAttribute("data-assignment")),ae.activeStudent=parseInt(t[0].getAttribute("data-student")),this.shadowRoot.querySelector("#studentgrid").style.height="140px",this.maintainScrollPosition())}},{key:"mouseHighlight",value:function(e){var t=this,n=r.normalizeEventPath(e)[0];clearTimeout(this.__mdebounce),this.__mdebounce=setTimeout((function(){n&&n.getAttribute("data-assignment")!=t.__activeHoverAssignment&&(t.shadowRoot.querySelectorAll('#studentgrid .th-or-td[data-assignment="'+t.__activeHoverAssignment+'"]').forEach((function(e){e.classList.remove("col-highlight")})),t.__activeHoverAssignment=n.getAttribute("data-assignment"),t.shadowRoot.querySelectorAll('#studentgrid .th-or-td[data-assignment="'+t.__activeHoverAssignment+'"]').forEach((function(e){e.classList.add("col-highlight")})))}),10)}},{key:"mouseLeave",value:function(e){var t=this;clearTimeout(this.__mdebounce),this.__mdebounce=setTimeout((function(){t.shadowRoot.querySelectorAll("#studentgrid .th-or-td").forEach((function(e){e.classList.remove("col-highlight")}))}),100)}},{key:"settingChanged",value:function(e){e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault(),this.settings[e.detail.name]=e.detail.value,this.settings=O({},this.settings)}},{key:"handleGridScaling",value:function(e){var t=r.normalizeEventPath(e);"TABLE"===t[0].tagName&&(""!=t[0].style.height?t[0].style.height=null:t[0].style.height="90vh")}},{key:"checkTabHeight",value:function(e){parseInt(this.shadowRoot.querySelector("#studentgrid").getBoundingClientRect().height)/window.innerHeight>.65&&(this.shadowRoot.querySelector("#studentgrid").style.height=null)}},{key:"studentreportClick",value:function(e){var t=this;l.ESGlobalBridgeStore.import("jspdf",new URL("./lib/","undefined"==typeof document&&"undefined"==typeof location?new(require("url").URL)("file:"+__filename).href:"undefined"==typeof document?location.href:document.currentScript&&document.currentScript.src||new URL("grade-book.umd.js",document.baseURI).href).href+"jspdf.min.js").then((function(){var e=new jsPDF;e.fromHTML(t.shadowRoot.querySelector("#studentreport").outerHTML,15,15);var n=new Date,i="".concat(n.getFullYear(),"-").concat(n.getMonth(),"-").concat(n.getDate(),"__").concat(n.getHours(),"-").concat(n.getMinutes(),"-").concat(n.getSeconds()),a="".concat(t.database.roster[t.activeStudent].student,"--").concat(t.database.assignments[t.activeAssignment].shortName,"--").concat(i,".pdf");e.save(a)}))}},{key:"openWindow",value:function(e){var t=this;this.__openWindow&&!this.__openWindow.closed?this.__openWindow.focus():(this.__openWindow=window.open("","studentwork","left=0,top=0,width=".concat(screen.width/2,",height=").concat(screen.height/2,",menubar=0,location=0,toolbar=0,status=0")),this.__openWindow.onbeforeunload=function(){t.displayMode=0,t.__openWindow=null}),this.renderSubmissionInWindow()}},{key:"renderSubmissionInWindow",value:function(){this.__openWindow&&2===this.displayMode&&(this.__openWindow.document.body.style.margin="0",i.render(i.html(Ce||(Ce=M([" ",""])),this.database.assignments.length&&this.database.assignments[this.activeAssignment]?i.html(Te||(Te=M(["<grade-book-pop-up></grade-book-pop-up>"]))):i.html(Me||(Me=M(["",""])),this.t.noSubmission)),this.__openWindow.document.body))}},{key:"render",value:function(){var e=this;return i.html(Ue||(Ue=M(['\n      <loading-indicator full ?loading="','"></loading-indicator>\n      <div class="top-controls">\n        <div class="group divider-right app-name">\n          <slot name="app-name"></slot>\n        </div>\n        <div class="group divider-right">\n          ','\n          <simple-icon-button-lite\n            @click="','"\n            value="prev"\n            title="','"\n            ?disabled="','"\n            icon="arrow-upward"\n          >\n            <span class="hide-900" value="prev">','</span>\n          </simple-icon-button-lite>\n          <simple-icon-button-lite\n            @click="','"\n            value="next"\n            title="','"\n            icon="arrow-downward"\n            ?disabled="','"\n          >\n            <span class="hide-900" value="next">','</span>\n          </simple-icon-button-lite>\n        </div>\n        <div class="group divider-right">\n          ','\n          <simple-icon-button-lite\n            @click="','"\n            value="prev"\n            title="','"\n            icon="arrow-back"\n            ?disabled="','"\n          >\n            <span class="hide-900" value="prev">','</span>\n          </simple-icon-button-lite>\n          <simple-icon-button-lite\n            @click="','"\n            value="next"\n            title="','"\n            ?disabled="','"\n            icon="arrow-forward"\n          >\n            <span class="hide-900" value="next">','</span>\n          </simple-icon-button-lite>\n        </div>\n        <div class="group">','</div>\n        <div class="group">',"</div>\n        ",'\n      </div>\n      <div ?hidden="','" class="source-selection">\n        <label>','..</label>\n        <select id="source" @change="','">\n          ','\n          <option\n            value="googledocs"\n            ?selected="','"\n          >\n            Google docs\n          </option>\n          <option value="url">URL endpoint (JSON)</option>\n          <option value="json">JSON data blob</option>\n        </select>\n        <simple-icon-button-lite\n          @click="','"\n          title="','"\n          ?disabled="','"\n          icon="folder-shared"\n        >\n          <span class="hide-900">',"</span>\n        </simple-icon-button-lite>\n        ",'\n        <input\n          id="sourcedata"\n          placeholder="','"\n          ?hidden="','"\n        />\n        <textarea\n          id="sourcedatablob"\n          rows="10"\n          cols="40"\n          placeholder="','"\n          ?hidden="','"\n        ></textarea>\n      </div>\n      ','\n      <table\n        id="studentgrid"\n        @mousemove="','"\n        @mouseleave="','"\n        @click="','"\n        @dblclick="','"\n        bordered\n        column-header\n        condensed\n        disable-responsive\n        scroll\n        striped\n        numeric-styles\n        sort\n        ?hidden="','"\n      >\n        ','\n      </table>\n      <a11y-tabs\n        id="studentassessment"\n        full-width\n        @click="','"\n        @a11y-tabs-active-changed="','"\n        ?hidden="','"\n      >\n        <a11y-tab\n          id="assessment"\n          icon="assignment-ind"\n          label="','"\n        >\n          ','\n        </a11y-tab>\n        <a11y-tab\n          id="studentreporttab"\n          icon="assignment"\n          label="','"\n        >\n          <simple-icon-button-lite\n            @click="','"\n            title="Download PDF"\n            icon="image:picture-as-pdf"\n          >\n            <span class="hide-900" value="prev">Download PDF</span>\n          </simple-icon-button-lite>\n          <div id="studentreport">\n            ',"\n          </div>\n        </a11y-tab>\n      </a11y-tabs>\n    "])),this.loading,this.renderActiveStudentBtn(),this.changeStudent,this.t.previousStudent,0===this.activeStudent||!this.ready,this.t.previous,this.changeStudent,this.t.nextStudent,this.database.roster.length-1===this.activeStudent||!this.ready,this.t.next,this.renderActiveAssignmentBtn(),this.changeAssignment,this.t.previousAssignment,0===this.activeAssignment||!this.ready,this.t.previous,this.changeAssignment,this.t.nextAssignment,this.database.assignments.length-1===this.activeAssignment||!this.ready,this.t.next,this.renderGradeScaleBtn(),this.renderSettingsBtn(),this.ready&&"filesystem"===this.source&&this.sourceData?i.html(We||(We=M(['\n              <div class="group">\n                <simple-icon-button-lite\n                  @click="','"\n                  title="','"\n                  ?disabled="','"\n                  icon="save"\n                >\n                  <span class="hide-900">',"</span>\n                </simple-icon-button-lite>\n              </div>\n            "])),this.saveToFilesystem,this.t.saveGradebook,!this.sourceData,this.t.saveGradebook):i.nothing,this.sourceData,this.t.selectGradebookSource,this.selectSource,this.hasFilePicker?i.html(He||(He=M(['<option\n                value="filesystem"\n                ?selected="','"\n              >\n                File system\n              </option>'])),"filesystem"===this.source):i.nothing,"googledocs"===this.source,this.loadFromSource,this.t.loadGradebook,this.sourceData,this.t.loadGradebook,"filesystem"==this.source&&this.prevLocalFileReference?i.html(Je||(Je=M(['\n              <simple-icon-button-lite\n                @click="','"\n                title="','"\n                ?disabled="','"\n                icon="folder-shared"\n              >\n                <span class="hide-900"\n                  >'," ","</span\n                >\n              </simple-icon-button-lite>\n            "])),this.loadFromExistingSource,this.t.loadGradebook,this.sourceData,this.t.load,this.prevLocalFileReference.name):i.nothing,this.t.sourceData,!["googledocs","url"].includes(this.source),this.t.pasteValidJSONHere,"json"!=this.source,"filesystem"===this.source&&this.loading?i.html(Ve||(Ve=M(['<p class="source-selection">',"</p>"])),this.t.loadingFilePleaseWait):i.nothing,this.mouseHighlight,this.mouseLeave,this.activateOption,this.handleGridScaling,!(this.database.assignments&&this.database.assignments[this.activeAssignment]),this.database.roster.length&&this.database.assignments.length?i.html(Xe||(Xe=M(["\n              <colgroup>\n                <col />\n              </colgroup>\n              ",'\n              <thead class="thead">\n                <tr class="tr thead-tr" part="tr">\n                  <th\n                    class="th th-or-td student-table-label"\n                    data-assignment="-1"\n                  >\n                    <div>\n                      '," ("," /\n                      ",")\n                    </div>\n                  </th>\n                  ",'\n                </tr>\n              </thead>\n              <tbody class="tbody">\n                ',"\n              </tbody>\n            "])),this.database.assignments.map((function(e,t){return i.html(Ye||(Ye=M(["<colgroup>\n                    <col />\n                  </colgroup>"])))})),this.t.student,parseInt(this.activeStudent+1),this.database.roster.length,this.database.assignments.map((function(e,t){return i.html(Ke||(Ke=M(['<th\n                        class="th th-or-td assignment-name"\n                        title="','"\n                        data-assignment="','"\n                      >\n                        \x3c!-- @todo add once we support multi-select <simple-fields-field\n                          data-assignment="','"\n                          type="checkbox"\n                          class="select-all"\n                          title="Select all submissions ','"\n                          name="select-all-submission"\n                          aria-label="','"\n                        ></simple-fields-field> --\x3e\n                        ',"\n                      </th>"])),e.name,t,t,e.shortName,e.shortName,e.shortName)})),this.database.roster.map((function(t,n){return i.html($e||($e=M([' <tr class="tr tbody-tr">\n                    <th class="th th-or-td" data-assignment="-1">\n                      <div class="user-info">\n                        <div class="user-left">\n                          ','\n                        </div>\n                        <div class="user-right">\n                          ',"\n                          ","\n                          ","\n                        </div>\n                      </div>\n                    </th>\n                    ","\n                  </tr>"])),e.settings.photo?i.html(Qe||(Qe=M(["",""])),t.photo?i.html(Ze||(Ze=M(['<img\n                                    src="','"\n                                    loading="lazy"\n                                    class="user-photo"\n                                  />'])),t.photo):i.html(et||(et=M(['<simple-icon-lite\n                                    icon="social:person"\n                                    class="user-photo"\n                                  ></simple-icon-lite>'])))):i.nothing,e.settings.fname?i.html(tt||(tt=M(["<div>","</div>"])),t.student):i.nothing,e.settings.surname?i.html(nt||(nt=M(["<div>","</div>"])),t.student):i.nothing,e.settings.email?i.html(it||(it=M(['<div>\n                                <a href="mailto:','" target="_blank"\n                                  >',"</a\n                                >\n                              </div>"])),t.email,t.email):i.nothing,e.database.assignments.map((function(a,s){return i.html(at||(at=M([' <td\n                        class="td th-or-td"\n                        numeric\n                        data-student="','"\n                        data-assignment="','"\n                        ?data-active="','"\n                      >\n                        <button\n                          aria-label="',"'s assignement ",'"\n                          data-student="','"\n                          data-assignment="','"\n                        >\n                          ',"\n                        </button>\n                      </td>"])),n,s,e.activeStudent===n&&e.activeAssignment===s,t.student,a.name,n,s,e.database.grades[n]&&e.database.grades[n][a.shortName]?i.html(st||(st=M(["",""])),e.database.grades[n][a.shortName]):"-")})))}))):i.nothing,this.checkTabHeight,this.updateStudentReport,!(this.database.assignments&&this.database.assignments[this.activeAssignment]),this.t.activeAssessment,this.activeRubric[0]?i.html(rt||(rt=M(['\n                <grid-plate\n                  disable-responsive\n                  layout="','"\n                >\n                  <div slot="col-1" class="tag-group">\n                    ',"\n                    ",'\n                  </div>\n                  <div slot="col-2">\n                    <h3>',"</h3>\n                    ",'\n                    <div class="student-feedback-wrap">\n                      <div class="student-feedback-text">\n                        <h3 class="heading">Overall feedback</h3>\n                        <simple-fields-field\n                          type="textarea"\n                          data-criteria="overall"\n                          data-rubric-written\n                        ></simple-fields-field>\n                      </div>\n                      <div class="student-feedback-score">\n                        <simple-icon-button-lite\n                          icon="','"\n                          @click="','"\n                        ></simple-icon-button-lite>\n                        <simple-fields-field\n                          ?disabled="','"\n                          type="number"\n                          min="0"\n                          id="totalpts"\n                          maxlength="10"\n                          @value-changed="','"\n                        ></simple-fields-field>\n                        /\n                        ','\n                        pts\n                        <letter-grade\n                          style="margin:-8px 0 0 16px;"\n                          total="','"\n                          score="','"\n                        ></letter-grade>\n                      </div>\n                    </div>\n                  </div>\n                  ',"\n                </grid-plate>\n              "])),this.displayModeData()[this.displayMode].layout,this.renderDisplayModeBtn(),this.database.tags.categories.length>0?i.html(ot||(ot=M(["\n                          <a11y-collapse-group heading-button>\n                            ","\n                          </a11y-collapse-group>\n                        "])),this.database.tags.categories.map((function(t,n){return i.html(lt||(lt=M(['\n                                <a11y-collapse>\n                                  <div slot="heading">\n                                    <simple-colors\n                                      accent-color="','"\n                                      ><span></span></simple-colors\n                                    >','\n                                  </div>\n                                  <div slot="content">\n                                    ',"\n                                  </div>\n                                </a11y-collapse>\n                              "])),e.pickColor(n),t,e.database.tags.data.filter((function(e){return e.category.includes(t)})).map((function(t){return i.html(dt||(dt=M(['<simple-tag\n                                            draggable="true"\n                                            tabindex="0"\n                                            @keypress="','"\n                                            @dragstart="','"\n                                            accent-color="','"\n                                            value="','"\n                                            .data="','"\n                                          ></simple-tag>'])),e.keyDown,e.setDragTransfer,e.pickColor(n),t.term,t)})))}))):i.nothing,this.activeRubric[0].name,this.activeRubric.map((function(t,n){return i.html(ct||(ct=M(["\n                        ",'\n                        <letter-grade-picker></letter-grade-picker>\n\n                        <editable-table-display\n                          accent-color="','"\n                          bordered\n                          column-header\n                          condensed\n                          disable-responsive\n                          scroll\n                          striped\n                        >\n                          <table>\n                            <tbody>\n                              <tr>\n                                ',"\n                              </tr>\n                              <tr>\n                                ","\n                              </tr>\n                            </tbody>\n                          </table>\n                        </editable-table-display>\n                        <h4>Additional ",' feedback</h4>\n                        <simple-fields-field\n                          type="textarea"\n                          data-rubric-written\n                          data-criteria="','"\n                        ></simple-fields-field>\n                      '])),e.renderRubricInfoBtn(n,t.criteria,t.description),e.accentColor,t.qualitative.map((function(e){return i.html(ut||(ut=M([" <td>","</td> "])),e)})),t.qualitative.map((function(e){return i.html(ht||(ht=M(['\n                                    <td>\n                                      <simple-fields-tag-list\n                                        style="background-color:transparent;"\n                                        data-criteria="','"\n                                        label="','"\n                                      ></simple-fields-tag-list>\n                                    </td>\n                                  '])),t.criteria,e)})),t.criteria,t.criteria)})),this.scoreLock?"lock":"lock-open",this.toggleLock,this.scoreLock,this.totalScoreChangedEvent,this.database.assignments[this.activeAssignment].points,this.database.assignments[this.activeAssignment].points,this.totalScore,2!=this.displayMode?i.html(pt||(pt=M(['\n                        <div slot="col-3">\n                          ',"\n                        </div>\n                      "])),this.database.assignments.length&&this.database.assignments[this.activeAssignment]?i.html(gt||(gt=M(["",""])),this.activeSubmission?this.renderSubmission(this.activeSubmission):i.html(mt||(mt=M(["",""])),this.t.noSubmission)):i.nothing):i.nothing):i.nothing,this.t.studentReportView,this.studentreportClick,!this.loading&&this.database.assignments&&this.database.assignments[this.activeAssignment]?i.html(bt||(bt=M(['\n                  <letter-grade\n                    class="student-report-score"\n                    show-scale\n                    total="','"\n                    score="','"\n                  ></letter-grade>\n                  <h2>Feedback report</h2>\n                  <div class="student-report-wrap">\n                    <a11y-collapse-group\n                      heading-button\n                      expanded\n                      style="width:80%;"\n                    >\n                      ','\n                      <a11y-collapse class="student-feedback-text">\n                        <div slot="heading" class="heading">\n                          <span style="font-size:20px;"\n                            >','</span\n                          >\n                        </div>\n                        <div slot="content">\n                          <p>','</p>\n                          <h2>Your total Score</h2>\n                          <div class="score-display">\n                            '," /\n                            ","\n                            pts\n                          </div>\n                        </div>\n                      </a11y-collapse>\n                    </a11y-collapse-group>\n                  </div>\n                "])),this.database.assignments[this.activeAssignment].points,this.totalScore,this.database.rubrics.filter((function(t){return t.shortName==e.database.assignments[e.activeAssignment].rubric})).map((function(t){return i.html(vt||(vt=M(['\n                            <a11y-collapse class="student-feedback-text">\n                              <div slot="heading" class="heading">\n                                <span style="font-size:20px;"\n                                  >','</span\n                                >\n                              </div>\n                              <div slot="content">\n                                <div class="student-feedback-score-heading">\n                                  <div>\n                                    '," /\n                                    ","\n                                  </div>\n                                  <h3>Criteria details</h3>\n                                </div>\n                                <p>","</p>\n                                <h3>Your feedback</h3>\n                                <ul>\n                                  ","\n                                </ul>\n                                <h3>Additional Criteria feedback</h3>\n                                <p>\n                                  ","\n                                </p>\n                              </div>\n                            </a11y-collapse>\n                          "])),t.criteria,e.getCriteriaScore(t.criteria),Math.round(t.percentage/100*e.database.assignments[e.activeAssignment].points),t.description,t.qualitative.map((function(n){return i.html(ft||(ft=M(["\n                                      <h4>","</h4>\n                                      <ul>\n                                        ","\n                                      </ul>\n                                    "])),n,e.activeGrading[t.criteria]?i.html(yt||(yt=M(["",""])),e.activeGrading[t.criteria][n].map((function(e){return i.html(wt||(wt=M([" <li>\n                                                <span>","</span\n                                                >","\n                                                ","\n                                              </li>"])),e.term,e.description?i.html(kt||(kt=M([" - ",""])),e.description):"",e.associatedMaterial?i.html(St||(St=M(["\n                                                      <ul>\n                                                        ","\n                                                      </ul>\n                                                    "])),e.associatedMaterial.map((function(e){return i.html(xt||(xt=M(['\n                                                            <li>\n                                                              <a\n                                                                href="','"\n                                                                target="_blank"\n                                                                rel="noopener noreferrer"\n                                                                >',"</a\n                                                              >\n                                                            </li>\n                                                          "])),e,e)}))):"")}))):"")})),e.getCriteriaFeedback(t.criteria))})),this.t.overallFeedback,this.getCriteriaFeedback("overall"),this.totalScore,this.database.assignments[this.activeAssignment].points):i.nothing)}},{key:"selectSource",value:function(e){this.source=this.shadowRoot.querySelector("#source").value}},{key:"loadFromSource",value:function(e){this.source=this.shadowRoot.querySelector("#source").value,"json"===this.source?this.sourceData=this.shadowRoot.querySelector("#sourcedatablob").value:"filesystem"==this.source?this.loadFromFilesystem():this.sourceData=this.shadowRoot.querySelector("#sourcedata").value}},{key:"loadFromExistingSource",value:function(e){this.source=this.shadowRoot.querySelector("#source").value,this.loadFromFilesystem(!0)}},{key:"loadFromFilesystem",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t?(this.loading=!0,setTimeout((function(){R.XLSXFileSystemBrokerSingleton.processFile(e.prevLocalFileReference,"json"),e.sourceData=e.prevLocalFileReference}),0)):R.XLSXFileSystemBrokerSingleton.loadFile("xls").then(function(){var t=_(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,A.set("grade-book-prev-file",n);case 3:setTimeout((function(){R.XLSXFileSystemBrokerSingleton.processFile(n,"json"),e.sourceData=n}),0);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"saveToFilesystem",value:(t=_(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=R.XLSXFileSystemBrokerSingleton.workbookFromJSON(this.database),i=new Blob([n],{type:"application/octet-stream"}),(new FileReader).readAsDataURL(i),e.next=6,R.XLSXFileSystemBrokerSingleton.saveFile("xlsx",n);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"rubricCriteriaPointsChange",value:function(e){var t=this;null!=e.detail.getAttribute("data-rubric-score")&&(clearTimeout(this.__debounce),this.__debounce=setTimeout(_(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.loading||(t.updateTotalScore(),t.shadowRoot.querySelector("#totalpts").value=t.totalScore),t.scoreLock=!0;case 2:case"end":return e.stop()}}),e)}))),0))}},{key:"updateTotalScore",value:function(){var e=0,t=this.shadowRoot.querySelectorAll("#assessment simple-fields-field[type='number']:not(#totalpts)");for(var n in Array.from(t))t[n].value&&(e+=parseInt(t[n].value));this.totalScore=e,this.shadowRoot.querySelector("#totalpts").value=e,this.requestUpdate()}},{key:"totalScoreChangedEvent",value:function(e){this.ready&&(e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault(),this.totalScore=e.detail.value,this.database.grades[this.activeStudent][this.database.assignments[this.activeAssignment].shortName]=this.totalScore,this.activeStudentSubmissions=[],this.activeStudentSubmissions=U(this.getStudentSubmissions(this.activeStudent)),this.requestUpdate())}},{key:"toggleLock",value:function(e){this.scoreLock=!this.scoreLock}},{key:"updateStudentReport",value:function(){this.requestUpdate()}},{key:"getCriteriaScore",value:function(e){var t=this.shadowRoot.querySelectorAll("#assessment editable-table-display");for(var n in Array.from(t))if(t[n].shadowRoot.querySelector('[data-rubric-score][data-criteria="'.concat(e,'"]')))return t[n].shadowRoot.querySelector('[data-rubric-score][data-criteria="'.concat(e,'"]')).value;return 0}},{key:"getCriteriaFeedback",value:function(e){return this.shadowRoot.querySelector('#assessment [data-rubric-written][data-criteria="'.concat(e,'"]'))?this.shadowRoot.querySelector('#assessment [data-rubric-written][data-criteria="'.concat(e,'"]')).value:""}},{key:"qualitativeFeedbackUpdate",value:function(e){this.activeGrading[e.detail.getAttribute("data-criteria")]||(this.activeGrading[e.detail.getAttribute("data-criteria")]={}),this.activeGrading[e.detail.getAttribute("data-criteria")][e.detail.label]=e.detail.tagList,this.requestUpdate()}},{key:"keyDown",value:function(e){e.key}},{key:"pickColor",value:function(e){for(var t=Object.keys(this.colors);e>t.length;)e-=t.length;return t[e]}},{key:"_handleDragDrop",value:function(e){window.dispatchEvent(new CustomEvent("simple-tag-drop",{detail:{value:"drop"}}))}},{key:"setDragTransfer",value:function(e){window.dispatchEvent(new CustomEvent("simple-tag-dragstart",{detail:{value:e.target}}));var t=e.target.data;t.color=e.target.accentColor,e.dataTransfer.setData("text",JSON.stringify(t))}}],[{key:"properties",get:function(){return O(O({},T(G(d),"properties",this)),{},{displayMode:{type:Number},settings:{type:Object},disabled:{type:Boolean,reflect:!0},loading:{type:Boolean,reflect:!0},ready:{type:Boolean,reflect:!0},activeStudent:{type:Number,attribute:"active-student"},activeAssignment:{type:Number,attribute:"active-assignment"},totalScore:{type:Number},scoreLock:{type:Boolean},source:{type:String},sourceData:{type:String,attribute:"source-data"},activeSubmission:{type:String,attribute:!1},database:{type:Object,attribute:!1},activeRubric:{type:Object,attribute:!1},assessmentView:{type:Object,attribute:!1},activeGrading:{type:Object,attribute:!1},activeStudentSubmissions:{type:Array}})}},{key:"styles",get:function(){return[].concat(U(T(G(d),"styles",this)),[i.css(At||(At=M(['\n        :host {\n          display: block;\n        }\n        :host [hidden] {\n          display: none !important;\n        }\n        @media (max-width: 900px) {\n          .hide-900 {\n            display: none;\n          }\n        }\n        loading-indicator {\n          --loading-indicator-background-color: var(\n            --simple-colors-default-theme-accent-2,\n            grey\n          );\n          --loading-indicator-color: var(\n            --simple-colors-default-theme-accent-10,\n            black\n          );\n        }\n        loading-indicator[full] {\n          top: 0;\n          position: absolute;\n          left: 0;\n          right: 0;\n          z-index: 1;\n        }\n        h1,\n        h2,\n        h3,\n        h4 {\n          margin: 0;\n        }\n        grid-plate {\n          --hax-layout-container-transition: none;\n          --grid-plate-col-transition: none;\n          --grid-plate-item-margin: 0px;\n          --grid-plate-item-padding: 8px;\n        }\n        #studentassessment {\n          --a11y-tabs-border-color: var(\n            --simple-colors-default-theme-accent-10,\n            black\n          );\n          --a11y-tabs-border-color: var(\n            --simple-colors-default-theme-accent-10,\n            black\n          );\n          color: var(--simple-colors-default-theme-grey-12);\n          background-color: var(--simple-colors-default-theme-grey-1);\n          --a11y-tabs-faded-color: var(--simple-colors-default-theme-grey-11);\n          --a11y-tabs-focus-color: var(--simple-colors-default-theme-grey-10);\n          --a11y-tabs-faded-background: var(\n            --simple-colors-default-theme-grey-2\n          );\n        }\n        #studentassessment::part(content) {\n          overflow: scroll;\n        }\n        a11y-collapse {\n          --a11y-collapse-border-color: var(\n            --simple-colors-default-theme-accent-10,\n            black\n          );\n          --a11y-collapse-horizontal-padding: 8px;\n          --a11y-collapse-vertical-padding: 4px;\n        }\n        a11y-collapse:not([expanded]):hover {\n          background-color: var(--simple-colors-default-theme-accent-1, grey);\n        }\n        a11y-collapse div[slot="heading"] {\n          font-size: 18px;\n          font-weight: normal;\n          cursor: pointer;\n          line-height: 30px;\n          display: flex;\n        }\n        a11y-collapse[expanded] div[slot="heading"] {\n          font-weight: bold;\n        }\n        .active-student-grade-history letter-grade {\n          display: inline-flex;\n          margin: 2px;\n        }\n        .active-student-grade-history button {\n          opacity: 0.4;\n          background-color: transparent;\n          border: 0;\n          padding: 0;\n          margin: 0;\n        }\n        .active-student-grade-history button.activeAssignment {\n          opacity: 0.9;\n          background-color: var(--simple-colors-default-theme-yellow-8);\n        }\n        .active-student-grade-history button:focus,\n        .active-student-grade-history button:active,\n        .active-student-grade-history button:hover {\n          opacity: 1;\n          outline: 1px solid black;\n          outline-offset: 2px;\n        }\n        simple-fields-tag-list {\n          --simple-fields-tag-list-possible: var(\n            --simple-colors-default-theme-accent-2\n          );\n          --simple-fields-tag-list-focus: var(\n            --simple-colors-default-theme-accent-10\n          );\n        }\n        simple-colors[accent-color] {\n          display: inline-flex;\n          width: 24px;\n          height: 24px;\n          margin: 4px 6px 0 0;\n        }\n        simple-colors[accent-color] span {\n          display: inline-flex;\n          width: 24px;\n          height: 24px;\n          background-color: var(\n            --simple-colors-default-theme-accent-3,\n            #eeeeee\n          );\n        }\n        simple-fields-field[type="textarea"] {\n          --simple-fields-font-size: 20px;\n        }\n        .source-selection {\n          text-align: center;\n          margin-top: 30vh;\n          font-size: 32px;\n        }\n        .source-selection label {\n          display: block;\n        }\n        .source-selection select {\n          font-size: 18px;\n        }\n        #sourcedata,\n        #sourcedatablob {\n          display: block;\n          margin: 16px auto;\n          font-size: 24px;\n        }\n        simple-fields-field[type="number"] {\n          --simple-fields-font-size: 40px;\n          line-height: 40px;\n        }\n\n        .student-feedback-score-heading {\n          display: flex;\n          font-size: 28px;\n          font-weight: bold;\n          line-height: 28px;\n          padding: 8px;\n        }\n        .student-feedback-score-heading h3 {\n          margin: 0 0 0 8px;\n          padding: 0;\n        }\n\n        #totalpts {\n          width: 84px;\n          margin: 0 12px;\n        }\n        #studentgrid {\n          display: block;\n          width: 100%;\n          height: 52vh;\n          max-height: 90vh;\n          min-height: 140px; /** exact height of a row to still be usable */\n          resize: vertical;\n          overflow: auto;\n          scrollbar-color: var(--simple-colors-default-theme-accent-10)\n            var(--simple-colors-default-theme-accent-1);\n          scrollbar-width: auto;\n        }\n        /** start scroll bar styling */\n        #studentgrid::-webkit-scrollbar-track,\n        #studentassessment::-webkit-scrollbar-track {\n          -webkit-box-shadow: inset 0 0 2px rgba(0, 0, 0, 0.3);\n          border-radius: 20px;\n          background-color: var(--simple-colors-default-theme-accent-1);\n        }\n        #studentgrid::-webkit-scrollbar,\n        #studentassessment::-webkit-scrollbar {\n          width: 16px;\n          height: 16px;\n          background-color: var(--simple-colors-default-theme-accent-1);\n        }\n        #studentgrid::-webkit-scrollbar-thumb {\n          border-radius: 20px;\n          -webkit-box-shadow: inset 0 0 2px rgba(0, 0, 0, 0.3);\n          background-color: var(--simple-colors-default-theme-accent-10);\n        }\n        #studentgrid::-webkit-scrollbar-thumb:vertical,\n        #studentassessment::-webkit-scrollbar-thumb:vertical {\n          height: 100px;\n          width: 16px;\n        }\n        #studentgrid::-webkit-scrollbar-corner {\n          -webkit-box-shadow: inset 0 0 2px rgba(0, 0, 0, 0.3);\n          background-color: var(--simple-colors-default-theme-accent-10);\n        }\n        /** end scroll bar styling */\n        .student-table-label {\n          text-align: center;\n          vertical-align: middle;\n        }\n        #studentgrid simple-fields-field.select-all {\n          background-color: transparent;\n          float: left;\n          margin: -2px 0 0 -2px;\n          --simple-icon-width: 16px;\n          --simple-icon-height: 16px;\n        }\n        .student-table-label div {\n          border-right: 1px solid var(--editable-table-heading-color, #000);\n          height: 32px;\n          width: 100%;\n          line-height: 32px;\n          margin-left: 3px;\n        }\n        #studentgrid [data-active] {\n          background-color: var(\n            --simple-colors-default-theme-yellow-3\n          ) !important;\n        }\n        #studentgrid button {\n          background-color: transparent;\n          border: none;\n          border-radius: 0;\n          height: 80px;\n          width: 96px;\n          display: block;\n          padding: 0;\n          margin: 0;\n          color: var(--simple-colors-default-theme-grey-12);\n        }\n        #studentgrid button:focus,\n        #studentgrid button:hover {\n          cursor: pointer;\n          outline: 2px black solid;\n          outline-offset: -1px;\n          background-color: var(\n            --simple-colors-default-theme-yellow-4\n          ) !important;\n        }\n        #studentgrid .assignment-name {\n          max-width: 96px;\n          width: 96px;\n          overflow: hidden;\n          padding: 4px;\n          font-size: 14px;\n          text-align: center;\n        }\n        .student-feedback-wrap {\n          display: flex;\n        }\n        .student-feedback-wrap .student-feedback-text {\n          width: 80%;\n          margin: 0;\n        }\n        .student-feedback-wrap .student-feedback-text div.heading {\n          padding: 20px;\n        }\n        .student-feedback-wrap .student-feedback-score {\n          font-size: 40px;\n          line-height: 68px;\n          padding: 34px 16px;\n          display: flex;\n          width: 50%;\n        }\n        simple-tag {\n          margin: 2px;\n        }\n        simple-tag:focus,\n        simple-tag:hover {\n          --simple-fields-fieldset-border-color: var(\n            --simple-colors-default-theme-accent-10,\n            #eeeeee\n          );\n        }\n        .user-info {\n          display: flex;\n          font-size: 16px;\n          min-width: 140px;\n          font-family: sans-serif;\n          font-weight: normal;\n          border-right: 1px solid black;\n        }\n        .user-left {\n          display: inline-flex;\n        }\n        .user-right {\n          display: block;\n          padding: 0 4px 0 0;\n          margin: 12px 0;\n        }\n        .user-right div a {\n          color: var(--simple-colors-default-theme-grey-12);\n          text-decoration: none;\n        }\n        .user-right div a:hover,\n        .user-right div a:focus,\n        .user-right div a:active {\n          color: var(--simple-colors-default-theme-blue-8);\n          text-decoration: underline;\n        }\n        .user-right div {\n          display: block;\n          text-align: center;\n        }\n        .user-photo {\n          --simple-icon-height: 48px;\n          --simple-icon-width: 48px;\n          width: 48px;\n          height: 48px;\n          border-radius: 50%;\n          margin: 12px 6px;\n          float: left;\n          vertical-align: middle;\n        }\n        .active-submission {\n          max-height: 400px;\n          width: 60%;\n          overflow: auto;\n          margin: 0 auto;\n        }\n        .active-submission iframe {\n          height: 400px;\n          width: 60%;\n        }\n        .tag-group {\n          position: sticky;\n          top: 0;\n        }\n        .student-report-wrap {\n          display: flex;\n          justify-content: space-evenly;\n        }\n        .student-report-score {\n          position: absolute;\n          right: 40px;\n          margin-top: -20px;\n        }\n        editable-table-display::part(td),\n        editable-table-display::part(th) {\n          text-align: center;\n          vertical-align: top;\n          max-width: 250px;\n        }\n        editable-table-display::part(simple-fields-field) {\n          --simple-fields-font-size: 32px;\n          --simple-fields-text-align: center;\n          background-color: transparent;\n          max-width: 100px;\n          padding: 0 0 28px 0;\n          margin: 0;\n        }\n\n        table thead th {\n          padding: 4px !important;\n          position: sticky;\n          top: -2px;\n          z-index: 1;\n        }\n        table thead th:first-child {\n          position: sticky;\n          left: 0;\n          z-index: 2;\n        }\n        table tbody th {\n          position: sticky;\n          left: 0;\n          z-index: 1;\n        }\n\n        .col-highlight,\n        tr:hover td,\n        tr:hover th {\n          transition: 0.3s ease-in-out all;\n          background-color: var(\n            --simple-colors-default-theme-yellow-2\n          ) !important;\n        }\n        table {\n          width: calc(100% - 2 * var(--editable-table-border-width, 1px));\n          border-collapse: collapse;\n          border-width: var(--editable-table-border-width, 1px);\n          border-style: var(--editable-table-border-style, solid);\n          border-color: var(--simple-colors-default-theme-grey-6, #999);\n          font-weight: var(--editable-table-light-weight, 200);\n          color: var(--simple-colors-default-theme-grey-10, #222);\n          background-color: var(--simple-colors-default-theme-grey-1, #fff);\n        }\n        .th,\n        .td {\n          font-weight: var(--editable-table-light-weight, 200);\n          color: var(--simple-colors-default-theme-grey-10, #222);\n          background-color: var(--simple-colors-default-theme-grey-1, #fff);\n        }\n        caption {\n          font-size: var(\n            --editable-table-caption-font-size,\n            var(--editable-table-font-size, unset)\n          );\n          font-weight: var(--editable-table-heavy-weight, 600);\n          color: var(\n            --editable-table-caption-color,\n            var(--simple-colors-default-theme-grey-10, #222)\n          );\n          background-color: var(\n            --editable-table-caption-bg-color,\n            var(--simple-colors-default-theme-grey-1, #fff)\n          );\n          width: 100%;\n        }\n        .tr {\n          display: table-row;\n        }\n        .th-or-td {\n          display: table-cell;\n        }\n        .thead .th-or-td {\n          height: 32px;\n          padding: 0;\n          margin: 0;\n        }\n        .thead-tr .th {\n          background-color: var(--simple-colors-default-theme-grey-2, #e0e0e0);\n          font-weight: var(--editable-table-heavy-weight, 600);\n          color: var(--simple-colors-default-theme-grey-12, #000);\n        }\n        .tbody-tr .th {\n          font-weight: var(--editable-table-heavy-weight, 600);\n          color: var(--simple-colors-default-theme-grey-12, #000);\n          background-color: var(--simple-colors-default-theme-grey-1, #fff);\n          text-align: left;\n        }\n        table[bordered] .th,\n        table[bordered] .td {\n          border-width: var(--editable-table-border-width, 1px);\n          border-style: var(--editable-table-border-style, solid);\n          border-color: var(--simple-colors-default-theme-grey-6, #999);\n        }\n        table[condensed] {\n          --editable-table-cell-vertical-padding: var(\n            --editable-table-cell-vertical-padding-condensed,\n            2px\n          );\n          --editable-table-cell-horizontal-padding: var(\n            --editable-table-cell-horizontal-padding-condensed,\n            4px\n          );\n        }\n        table[striped] .tbody-tr:nth-child(2n + 1) .th-or-td {\n          background-color: var(--simple-colors-default-theme-grey-2, #f0f0f0);\n        }\n        .tfoot-tr .th,\n        .tfoot-tr .td {\n          border-top: 2px solid var(--simple-colors-default-theme-grey-10, #222);\n          font-weight: var(--editable-table-heavy-weight, 600);\n          color: var(--simple-colors-default-theme-grey-12, #000);\n        }\n        caption,\n        .th-or-td {\n          text-align: left;\n        }\n        table[numeric-styles] .thead-tr .th-or-td[numeric],\n        table[numeric-styles] .tfoot-tr .th-or-td[numeric],\n        table[numeric-styles] .th-or-td[numeric] {\n          text-align: center;\n          font-size: 24px;\n          font-family: sans-serif;\n          --editable-table-cell-justify: flex-end;\n        }\n        table[numeric-styles] .tfoot-tr .th-or-td[negative],\n        table[numeric-styles] .td[negative] {\n          color: var(--simple-colors-default-theme-red-7, red);\n          --editable-table-cell-color: var(\n            --editable-table-negative-color,\n            red\n          );\n        }\n\n        caption > div {\n          display: flex;\n          align-items: flex-end;\n          justify-content: space-between;\n        }\n        caption > div > *:not(:last-child) {\n          padding: 0 0 5px;\n        }\n        #column {\n          width: calc(var(--simple-picker-option-size) + 6px);\n          overflow: visible;\n          display: none;\n          margin-left: 10px;\n          --simple-picker-border-width: 1px;\n          --simple-picker-focus-border-width: 1px;\n          --simple-picker-border-color: var(\n            --simple-colors-default-theme-grey-6,\n            #999\n          );\n        }\n        .th,\n        .td {\n          padding: 0;\n        }\n        .top-controls {\n          background-color: var(--simple-colors-default-theme-accent-12);\n          color: var(--simple-colors-default-theme-accent-1);\n          height: 36px;\n          vertical-align: middle;\n          width: 100%;\n          display: flex;\n        }\n        .top-controls .group {\n          padding: 0 8px;\n        }\n        .top-controls .app-name {\n          padding: 0 24px 0 16px;\n        }\n        .top-controls simple-icon-button-lite span {\n          padding: 0 8px 0 0;\n        }\n        .top-controls .divider-left {\n          border-left: 1px solid var(--simple-colors-default-theme-accent-1);\n        }\n        .top-controls .divider-right {\n          border-right: 1px solid var(--simple-colors-default-theme-accent-1);\n        }\n      '])))])}},{key:"tag",get:function(){return"grade-book"}}]),d}(function(e){E(n,e);var t=F(n);function n(){var e;return D(this,n),(e=t.call(this)).hideGradeScale=!0,e.hideActiveStudentOverview=!0,e.hideActiveAssignment=!0,e.hideSettings=!0,e.hideRubricInfo=[],e}return L(n,[{key:"renderActiveStudentBtn",value:function(){var e=this;return i.html(be||(be=M(['<simple-icon-button-lite\n          @click="','"\n          id="activestudentbtn"\n          ?disabled="','"\n        >\n          ','\n          <span class="hide-900">','</span>\n        </simple-icon-button-lite>\n        <simple-popover\n          ?hidden="','"\n          for="activestudentbtn"\n          auto\n        >\n          <div>\n            ','\n\n            <div class="active-student-grade-history">\n              ',"\n            </div>\n          </div>\n        </simple-popover>"])),this.toggleActiveStudentOverview,!this.ready,this.database.roster[this.activeStudent]&&this.database.roster[this.activeStudent].photo?i.html(ve||(ve=M(['<img\n                src="','"\n                loading="lazy"\n              />'])),this.database.roster[this.activeStudent].photo):i.html(fe||(fe=M(['<simple-icon-lite icon="social:person"></simple-icon-lite>']))),this.t.activeStudent,this.hideActiveStudentOverview,this.database.roster[this.activeStudent]?i.html(ye||(ye=M([' <grade-book-student-block\n                  .student="','"\n                ></grade-book-student-block>'])),this.database.roster[this.activeStudent]):i.nothing,this.activeStudentSubmissions.map((function(t){return i.html(we||(we=M(['\n                  <button\n                    .value="','"\n                    @click="','"\n                    class="','"\n                  >\n                    <letter-grade\n                      mini\n                      label="','"\n                      .total="','"\n                      .score="','"\n                      .value="','"\n                    >\n                    </letter-grade>\n                  </button>\n                '])),t.assignmentIndex,e.studentLetterGradeHistoryClick,e.activeAssignment===t.assignmentIndex?"activeAssignment":"",t.assignmentName,t.assignmentPoints,t.studentScore,t.assignmentIndex)})))}},{key:"toggleActiveStudentOverview",value:function(e){this.hideActiveStudentOverview=!this.hideActiveStudentOverview,this.hideActiveStudentOverview||(this.hideSettings=!0,this.hideActiveAssignment=!0,this.hideGradeScale=!0)}},{key:"renderGradeScaleBtn",value:function(){return i.html(ke||(ke=M([' <simple-icon-button-lite\n          icon="list"\n          @click="','"\n          id="gradescalebtn"\n          ?disabled="','"\n        >\n          <span class="hide-900">','</span>\n        </simple-icon-button-lite>\n        <simple-popover\n          ?hidden="','"\n          for="gradescalebtn"\n          auto\n        >\n          <editable-table-display\n            accent-color="','"\n            bordered\n            column-header\n            condensed\n            disable-responsive\n            scroll\n            striped\n          >\n            <table>\n              <tbody>\n                <tr>\n                  <td>',"</td>\n                  <td>","</td>\n                  <td>","</td>\n                </tr>\n                ","\n              </tbody>\n            </table>\n          </editable-table-display>\n        </simple-popover>"])),this.toggleGradeScale,!this.ready,this.t.gradingScale,this.hideGradeScale,this.accentColor,this.t.letterGrade,this.t.highRange,this.t.lowRange,this.database.gradeScale.map((function(e){return i.html(Se||(Se=M(["\n                    <tr>\n                      <td>","</td>\n                      <td>","</td>\n                      <td>","</td>\n                    </tr>\n                  "])),e.letter,e.highRange,e.lowRange)})))}},{key:"toggleGradeScale",value:function(e){this.hideGradeScale=!this.hideGradeScale,this.hideGradeScale||(this.hideSettings=!0,this.hideActiveAssignment=!0,this.hideActiveStudentOverview=!0)}},{key:"renderSettingsBtn",value:function(){return i.html(xe||(xe=M([' <simple-icon-button-lite\n          icon="settings"\n          @click="','"\n          id="settings"\n          ?disabled="','"\n          class="divider-left"\n        >\n          <span class="hide-900">','</span>\n        </simple-icon-button-lite>\n        <simple-popover\n          ?hidden="','"\n          for="settings"\n          auto\n          @value-changed="','"\n        >\n          <simple-fields-field\n            value="','"\n            type="checkbox"\n            label="','"\n            name="photo"\n          ></simple-fields-field>\n          <simple-fields-field\n            value="','"\n            type="checkbox"\n            label="','"\n            name="email"\n          ></simple-fields-field>\n          <simple-fields-field\n            value="','"\n            type="checkbox"\n            label="','"\n            name="fname"\n          ></simple-fields-field>\n          <simple-fields-field\n            value="','"\n            type="checkbox"\n            label="','"\n            name="surname"\n          ></simple-fields-field>\n        </simple-popover>'])),this.toggleSettings,!this.ready,this.t.settings,this.hideSettings,this.settingChanged,this.settings.photo,this.t.photo,this.settings.email,this.t.email,this.settings.fname,this.t.firstName,this.settings.surname,this.t.surname)}},{key:"toggleSettings",value:function(e){this.hideSettings=!this.hideSettings,this.hideSettings||(this.hideGradeScale=!0,this.hideActiveAssignment=!0,this.hideActiveStudentOverview=!0)}},{key:"renderActiveAssignmentBtn",value:function(){return i.html(Ae||(Ae=M(['<simple-icon-button-lite\n          icon="assignment"\n          @click="','"\n          id="activeassignmentbtn"\n          ?disabled="','"\n        >\n          <span class="hide-900">','</span>\n        </simple-icon-button-lite>\n        <simple-popover\n          ?hidden="','"\n          for="activeassignmentbtn"\n          auto\n        >\n          ',"\n        </simple-popover>"])),this.toggleActiveAssignment,!this.ready,this.t.activeAssignment,this.hideActiveAssignment,this.database.assignments[this.activeAssignment]?i.html(Re||(Re=M(["\n                <h3>\n                  ","\n                </h3>\n                ",':\n                <local-time\n                  .datetime="','"\n                  month="short"\n                  day="numeric"\n                  year="numeric"\n                  hour="numeric"\n                  minute="numeric"\n                  time-zone-name="short"\n                >\n                </local-time>\n              '])),this.database.assignments[this.activeAssignment].name,this.t.dueDate,this.database.assignments[this.activeAssignment]._ISODueDate):i.nothing)}},{key:"toggleActiveAssignment",value:function(e){this.hideActiveAssignment=!this.hideActiveAssignment,this.hideActiveAssignment||(this.hideSettings=!0,this.hideGradeScale=!0,this.hideActiveStudentOverview=!0)}},{key:"renderRubricInfoBtn",value:function(e,t,n){return i.html(je||(je=M(['<simple-icon-button-lite\n          icon="info"\n          @click="','"\n          id="rubricinfo','"\n          data-id="','"\n        >\n          <span class="hide-900" data-id="','">','</span>\n        </simple-icon-button-lite>\n        <simple-popover\n          ?hidden="','"\n          for="rubricinfo','"\n          auto\n        >\n          <p style="max-width:20vw;">',"</p>\n        </simple-popover>"])),this.toggleRubricInfo,e,e,e,t,!this.hideRubricInfo[e],e,n)}},{key:"toggleRubricInfo",value:function(e){this.hideRubricInfo[parseInt(e.target.getAttribute("data-id"))]=!this.hideRubricInfo[parseInt(e.target.getAttribute("data-id"))],this.requestUpdate()}},{key:"renderDisplayModeBtn",value:function(){var e=this;return i.html(Oe||(Oe=M([" ",""])),this.displayModeData().map((function(t,n){return i.html(qe||(qe=M(['\n          <simple-icon-button-lite\n            icon="','"\n            @click="','"\n            data-id="','"\n            ?disabled="','"\n          >\n            <span class="hide-900" data-id="','">',"</span>\n          </simple-icon-button-lite>\n        "])),t.icon,e.toggleDisplayMode,n,e.displayMode===n,n,t.label)})))}},{key:"displayModeData",value:function(){return[{label:"Mode 1",icon:"view-array",layout:"1-1-2"},{label:"Mode 2",icon:"view-carousel",layout:"1-2-1"},{label:"Two windows",icon:"open-in-new",layout:"1-2"}]}},{key:"toggleDisplayMode",value:function(e){this.displayMode=parseInt(e.target.getAttribute("data-id")),2==this.displayMode&&this.openWindow()}}],[{key:"properties",get:function(){return O(O({},T(G(n),"properties",this)),{},{hideSettings:{type:Boolean},hideGradeScale:{type:Boolean},hideActiveStudentOverview:{type:Boolean},hideActiveAssignment:{type:Boolean},hideRubricInfo:{type:Array}})}},{key:"styles",get:function(){return[].concat(U(T(G(n),"styles",this)),[i.css(_e||(_e=M(["\n          .top-controls simple-icon-button-lite {\n            margin: 0;\n            border-radius: 0;\n            height: 36px;\n          }\n          .top-controls simple-icon-button-lite:not([disabled])::part(button) {\n            outline: none;\n            height: 36px;\n            border-radius: 0;\n            padding: 0 8px;\n          }\n          .top-controls\n            simple-icon-button-lite:not([disabled])::part(button):focus,\n          .top-controls\n            simple-icon-button-lite:not([disabled])::part(button):hover {\n            background-color: var(--simple-colors-default-theme-accent-11);\n            outline: 2px solid var(--simple-colors-default-theme-accent-1);\n            outline-offset: -2px;\n            color: var(--simple-colors-default-theme-accent-1);\n          }\n          #activestudentbtn img,\n          #activestudentbtn simple-icon-lite {\n            --simple-icon-width: 32px;\n            --simple-icon-height: 32px;\n            width: 32px;\n            height: 32px;\n            border-radius: 50%;\n            vertical-align: middle;\n            margin-right: 4px;\n          }\n        "])))])}}]),n}(s.I18NMixin(a.SimpleColors)));customElements.define(jt.tag,jt),window.GradeBook=window.GradeBook||{},window.GradeBook.requestAvailability=function(){return window.GradeBook.instance||(document.querySelector("grade-book")?window.GradeBook.instance=document.querySelector("grade-book"):(window.GradeBook.instance=document.createElement("grade-book"),document.body.appendChild(window.GradeBook.instance))),window.GradeBook.instance},e.GradeBook=jt,Object.defineProperty(e,"__esModule",{value:!0})}));
